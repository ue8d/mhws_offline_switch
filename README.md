# MHWS Offline Switch

モンスターハンターワイルズ（と推測されるゲーム）のオンライン接続とオフラインモードを簡易的に切り替えるためのWindows用ツールです。

Windows Defender ファイアウォールの設定を自動的に変更することで、ゲームのインターネット通信をワンクリックまたはホットキーで遮断・許可します。

![image.png](./image.png)

## 主な機能

- シンプルなUIによる通信ON/OFF切り替え
- 現在の通信状態（許可/ブロック）を色とテキストで表示
- グローバルホットキーによるアプリケーション外からの操作
- 対象となるゲーム実行ファイルのパスをGUIから簡単に変更可能
- 設定は `WildsNetSwitch.config.json` ファイルに自動保存
- 起動時に管理者権限を要求

## 配布

このツールは実行ファイル（`.exe`)形式で配布しています。Python環境がない方でもすぐにご利用いただけます。

**[最新版のダウンロードはこちらから](https://github.com/ue8d/mhws_offline_switch/releases/latest)**

リリースページから `WildsNetSwitch.exe` をダウンロードしてください。

## 使い方

### EXE版（推奨）

1.  ダウンロードした `WildsNetSwitch.exe` を実行します。
2.  初回起動時など、管理者権限で実行するためにUAC（ユーザーアカウント制御）のプロンプトが表示される場合があります。「はい」を選択してください。
3.  GUIが表示されたら、通信を制御したいゲームの実行ファイル（例: `MonsterHunterWilds.exe`）のパスを設定してください。
4.  以下のいずれかの方法で通信状態を切り替えられます。
    - 画面中央のスイッチをクリック
    - `スペース`キーを押す
    - 設定したホットキーを押す

### Pythonスクリプトから実行する場合

#### 必須環境

- Windows OS
- PowerShell
- Python 3.x

#### 手順

1.  このリポジトリをダウンロードまたはクローンします。
2.  必要なライブラリをインストールします。
    ```sh
    pip install keyboard
    ```
3.  以下のコマンドでスクリプトを実行します。
    ```sh
    python wilds_net_switch.py
    ```

## 設定

ツールを実行すると、同じディレクトリに `WildsNetSwitch.config.json` が自動的に生成されます。

- **`game_exe`**: 通信を制御したいゲームの実行ファイルのフルパスです。GUIの「変更」ボタンからいつでも変更できます。
- **`hotkey`**: 通信状態を切り替えるためのグローバルホットキーです。GUIの「変更」ボタンから設定できます。（例: `home`, `ctrl+alt+f12`）

```json
{
  "game_exe": "C:/SteamLibrary/steamapps/common/MonsterHunterWilds/MonsterHunterWilds.exe",
  "hotkey": "home"
}
```

## 仕組み

このツールは、Windows Defender ファイアウォールに `BlockWilds_WildsOutbound` という名前の送信ルールを追加/削除することで機能します。

- **ブロック（オフライン）**: 指定された実行ファイルのすべての**送信**接続をブロックするファイアウォールルールを作成し、有効化します。
- **許可（オンライン）**: 上記で作成したファイアウォールルールを**削除**し、OSのデフォルトの通信状態に戻します。

## ライセンス

このプロジェクトはMITライセンスの下で公開されています。
詳細は `LICENSE` ファイルをご覧ください。

## 免責事項

このツールを使用したことによって生じたいかなる損害についても、作者は一切の責任を負いません。自己責任でご利用ください。
